<div *ngIf="isLoaded; else stillLoading" class="col-sm-6 col-xl-12 mx-auto">
  <h3 class="mx-auto w-100 text-center">Users</h3>
  <mat-form-field>
    <input matInput (keyup)="applyFilter($event.target.value)" placeholder="Filter">
  </mat-form-field>
  <mat-table [dataSource]="data" class="mat-elevation-z8" matSort matSortActive="name, id">
    <ng-container matColumnDef="id">
      <mat-header-cell *matHeaderCellDef mat-sort-header>ID</mat-header-cell>
      <mat-cell *matCellDef="let user"> {{user.id}}</mat-cell>
    </ng-container>
    <ng-container matColumnDef="name">
      <mat-header-cell *matHeaderCellDef mat-sort-header>Username</mat-header-cell>
      <mat-cell *matCellDef="let user">{{user.username}}</mat-cell>
    </ng-container>
    <ng-container matColumnDef="reset">
      <mat-header-cell *matHeaderCellDef>Regenerate password</mat-header-cell>
      <mat-cell *matCellDef="let user"><button mat-icon-button color="primary" (click)="updatePwd(user.id, user.username)"><mat-icon>create</mat-icon></button></mat-cell>
    </ng-container>
    <ng-container matColumnDef="delete">
      <mat-header-cell *matHeaderCellDef>Delete</mat-header-cell>
      <mat-cell *matCellDef="let user"><button mat-icon-button color="error" (click)="deleteUser(user.id)"><mat-icon>delete</mat-icon></button></mat-cell>
    </ng-container>
    <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
    <mat-row *matRowDef="let row; columns: displayedColumns;"></mat-row>
  </mat-table>
  <button mat-fab color="primary" class="float-right mt-2 mr-3" (click)="createUser()"><mat-icon>add</mat-icon></button>
</div>
<ng-template #stillLoading>
  <loading-icon></loading-icon>
</ng-template>
